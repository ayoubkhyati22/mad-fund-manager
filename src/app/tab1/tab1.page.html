<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>
      Tableau de bord
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="dashboard-content">
  <div class="content-wrapper">
    <ion-header collapse="condense">
      <ion-toolbar>
        <ion-title size="large">Tableau de bord</ion-title>
      </ion-toolbar>
    </ion-header>

    <!-- Balance Section -->
    <div class="balance-section">
      <div class="balance-header">
        <span class="balance-label">My Balance</span>
        <ion-button fill="clear" size="small" class="stats-button">
          <ion-icon name="stats-chart" slot="start"></ion-icon>
          Statistics
        </ion-button>
      </div>

      <div class="balance-amount">
        <span class="amount">{{ getTotalBalance() | number:'1.2-2' }}</span>
        <span class="currency-code">MAD</span>
      </div>
    </div>

    <!-- Transactions Section -->
    <div class="transactions-section">
      <!-- Banks Summary Section -->
      <div class="banks-summary-section">
        <h3 class="section-title">Banks Summary</h3>

        <div class="bank-list">
          <div class="bank-item" *ngFor="let bank of banks; trackBy: trackByBankId" [class.expanded]="bank.isExpanded">
            <!-- Clickable Bank Header -->
            <div class="bank-header" (click)="toggleBank(bank)">
              <div class="bank-icon" [ngClass]="getBankIconClass(bank.id)">
                <span>{{ bank.icon }}</span>
              </div>
              <div class="bank-details">
                <h4>{{ bank.name }}</h4>
                <p>{{ bank.accountType }}</p>
              </div>
              <div class="bank-amount positive">
                {{ bank.balance | number:'1.2-2' }}
                <span class="status">MAD</span>
              </div>
              <ion-icon
                [name]="bank.isExpanded ? 'chevron-up' : 'chevron-down'"
                class="expand-icon">
              </ion-icon>
            </div>

            <!-- Objectives (shown/hidden based on isExpanded) -->
            <div class="objectives-container" *ngIf="bank.isExpanded">
              <div class="objective-item" *ngFor="let objective of bank.objectives; trackBy: trackByObjectiveId">
                <div class="objective-header">
                  <div class="objective-info">
                    <ion-icon [name]="objective.icon" [class]="'objective-icon ' + objective.iconClass"></ion-icon>
                    <div class="objective-details">
                      <span class="objective-name">{{ objective.name }}</span>
                      <span class="objective-progress-text">
                        {{ objective.currentAmount | number:'1.0-0' }} MAD / {{ objective.targetAmount | number:'1.0-0' }} MAD
                      </span>
                    </div>
                  </div>
                  <span class="objective-percentage">{{ getObjectiveProgress(objective) }}%</span>
                </div>
                <div class="progress-bar">
                  <div
                    class="progress-fill"
                    [ngClass]="objective.progressClass"
                    [style.width.%]="getObjectiveProgress(objective)">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</ion-content>
